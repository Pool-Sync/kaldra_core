(()=>{var e={};e.id=777,e.ids=[777],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6041:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(7107),t(1506),t(5866);var a=t(3191),r=t(8716),l=t(7922),n=t.n(l),i=t(5231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);t.d(s,d);let o=["",{children:["safeguard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7107)),"/Users/niki/Desktop/kaldra_core/4iam_frontend/app/safeguard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1506)),"/Users/niki/Desktop/kaldra_core/4iam_frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/niki/Desktop/kaldra_core/4iam_frontend/app/safeguard/page.tsx"],x="/safeguard/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/safeguard/page",pathname:"/safeguard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},2537:(e,s,t)=>{Promise.resolve().then(t.bind(t,9815))},8494:(e,s,t)=>{"use strict";t.d(s,{L:()=>c});var a=t(7577),r=t(9351);class l extends Error{constructor(e,s){super(e),this.name="ApiError",this.status=s}}let n="http://localhost:8000",i=e=>new Promise(s=>setTimeout(s,e));async function d(e,s,t=3){for(let a=0;a<=t;a++)try{let t=new AbortController,a=setTimeout(()=>t.abort(),15e3);try{let r=await fetch(e,{...s,signal:t.signal});if(clearTimeout(a),!r.ok){let e=await r.text().catch(()=>"");throw new l(`API error ${r.status}: ${e||r.statusText}`,r.status)}return await r.json()}finally{clearTimeout(a)}}catch(s){if(a===t)throw s;let e=1e3*Math.pow(2,a);console.warn(`API request failed (attempt ${a+1}/${t+1}), retrying in ${e}ms...`,s),await i(e)}throw new l("Max retries exceeded")}async function o(e){let s=e.trim();if(!s)throw new l("Input text must not be empty.");console.log(`[KALDRA Client] Using real API at ${n} (NEXT_PUBLIC_KALDRA_API_MODE=real)`);try{return await d(`${n}/engine/kaldra/signal`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})})}catch(e){return console.error("[KALDRA Client] Real API failed, falling back to mock data:",e),(0,r.At)(s)}}function c(e="",s={}){let[t,r]=(0,a.useState)(e),[l,n]=(0,a.useState)(null),[i,d]=(0,a.useState)(!1),[c,x]=(0,a.useState)(null),u=(0,a.useCallback)(async e=>{let s=(e??t).trim();if(s){d(!0),x(null);try{let e=await o(s);n(e)}catch(e){x(e)}finally{d(!1)}}},[t]);return{text:t,setText:r,data:l,isLoading:i,error:c,run:u}}},9815:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var a=t(326),r=t(7577),l=t(8494),n=t(8867),i=t(4112);function d(){let[e,s]=(0,r.useState)("Exemplo de narrativa para monitoramento pelo KALDRA-SAFEGUARD."),{text:t,setText:d,data:o,isLoading:c,error:x,run:u}=(0,l.L)(e),m=o?.narrative_risk??"n/d";return(0,a.jsxs)("main",{className:"flex flex-col gap-6 p-6",children:[(0,a.jsxs)("header",{className:"space-y-1",children:[a.jsx("h1",{className:"text-2xl font-semibold text-slate-50",children:"KALDRA-SAFEGUARD â€” Narrative Guard"}),a.jsx("p",{className:"text-sm text-slate-400",children:"Use o KALDRA CORE para monitorar riscos narrativos e vi\xe9s extremo."})]}),(0,a.jsxs)("section",{className:"grid gap-4 md:grid-cols-[minmax(0,2fr)_minmax(0,3fr)]",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("label",{className:"text-xs font-medium text-slate-300",children:"Narrative text"}),a.jsx("textarea",{className:"h-40 w-full rounded-xl border border-slate-800 bg-slate-950/80 p-3 text-sm text-slate-100 outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500",value:t||e,onChange:e=>{d(e.target.value),s(e.target.value)}}),a.jsx("button",{type:"button",onClick:()=>u(),disabled:c,className:"inline-flex items-center justify-center rounded-lg bg-sky-600 px-4 py-2 text-sm font-medium text-white hover:bg-sky-500 disabled:opacity-60",children:c?"Analyzing...":"Generate KALDRA Signal"}),x&&a.jsx("p",{className:"text-xs text-red-400 mt-1",children:x.message||"Unexpected error"})]}),a.jsx("div",{className:"space-y-4",children:o?(0,a.jsxs)(a.Fragment,{children:[a.jsx(n.u,{signal:o}),a.jsx(i.B,{signal:o}),(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-3 text-xs text-slate-300",children:[(0,a.jsxs)("div",{className:"font-semibold text-slate-100",children:["Narrative risk level: ",m]}),a.jsx("p",{className:"mt-1 text-slate-400",children:"Este n\xedvel \xe9 derivado do bias_score e do regime TW. A l\xf3gica detalhada ser\xe1 refinada em vers\xf5es futuras."})]})]}):a.jsx("div",{className:"rounded-xl border border-dashed border-slate-700 bg-slate-950/60 p-4 text-sm text-slate-400",children:"Nenhum sinal gerado ainda. Envie um texto para avaliar o risco narrativo."})})]})]})}},8867:(e,s,t)=>{"use strict";t.d(s,{u:()=>r});var a=t(326);function r({signal:e}){let s="UNSTABLE"===e.tw_regime?"bg-red-500":"CRITICAL"===e.tw_regime?"bg-amber-500":"bg-emerald-500",t=Math.round(100*e.bias_score),r=Math.round(100*e.confidence);return(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/60 p-4 shadow-md space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-xs uppercase tracking-wide text-slate-400",children:"KALDRA Signal"}),a.jsx("div",{className:"text-lg font-semibold text-slate-50",children:e.archetype||"Archetype: n/d"}),(0,a.jsxs)("div",{className:"text-xs text-slate-400",children:["Delta state:"," ",a.jsx("span",{className:"font-mono text-slate-200",children:e.delta_state})]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[a.jsx("div",{className:"text-xs uppercase text-slate-400",children:"TW Regime"}),(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full bg-slate-800 px-3 py-1",children:[a.jsx("span",{className:`h-2 w-2 rounded-full ${s}`}),a.jsx("span",{className:"text-xs font-semibold text-slate-50",children:e.tw_regime})]}),e.bias_label&&(0,a.jsxs)("div",{className:"text-[10px] uppercase tracking-wide text-slate-400",children:["Bias: ",e.bias_label]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-xs text-slate-300",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Bias score"}),(0,a.jsxs)("span",{className:"font-mono",children:[t,"%"]})]}),a.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-800",children:a.jsx("div",{className:"h-1.5 rounded-full bg-fuchsia-500",style:{width:`${t}%`}})})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Confidence"}),(0,a.jsxs)("span",{className:"font-mono",children:[r,"%"]})]}),a.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-800",children:a.jsx("div",{className:"h-1.5 rounded-full bg-sky-500",style:{width:`${r}%`}})})]})]}),e.narrative_risk&&(0,a.jsxs)("div",{className:"text-[11px] text-slate-400",children:["Narrative risk:"," ",a.jsx("span",{className:"font-semibold text-slate-100",children:e.narrative_risk})]}),a.jsx("p",{className:"text-xs text-slate-400 leading-relaxed",children:e.explanation})]})}},4112:(e,s,t)=>{"use strict";t.d(s,{B:()=>r});var a=t(326);function r({signal:e,maxBars:s=6}){let t=[...Object.entries(e.kindra_distribution||{})].sort((e,s)=>s[1]-e[1]).slice(0,s);if(!t.length)return a.jsx("div",{className:"rounded-xl border border-slate-800 bg-slate-900/40 p-3 text-xs text-slate-400",children:"No Kindra distribution available."});let r=Math.max(...t.map(([,e])=>e));return(0,a.jsxs)("div",{className:"rounded-xl border border-slate-800 bg-slate-900/40 p-3 space-y-2",children:[(0,a.jsxs)("div",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:["Kindra distribution (top ",t.length,")"]}),a.jsx("div",{className:"space-y-1.5",children:t.map(([e,s])=>(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsxs)("div",{className:"flex justify-between text-[11px] text-slate-300",children:[a.jsx("span",{className:"font-mono",children:e}),(0,a.jsxs)("span",{className:"font-mono",children:[Math.round(100*s),"%"]})]}),a.jsx("div",{className:"h-1.5 w-full rounded-full bg-slate-800",children:a.jsx("div",{className:"h-1.5 rounded-full bg-emerald-500",style:{width:`${s/r*100}%`}})})]},e))})]})}},7107:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var a=t(8570);let r=(0,a.createProxy)(String.raw`/Users/niki/Desktop/kaldra_core/4iam_frontend/app/safeguard/page.tsx`),{__esModule:l,$$typeof:n}=r;r.default;let i=(0,a.createProxy)(String.raw`/Users/niki/Desktop/kaldra_core/4iam_frontend/app/safeguard/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,892,28],()=>t(6041));module.exports=a})();